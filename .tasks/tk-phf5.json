{
  "project": "tk",
  "ref": "phf5",
  "title": "[AUDIT] Mode transitions - Input/Selector/Approval states",
  "description": null,
  "status": "done",
  "priority": 1,
  "labels": [],
  "assignees": [],
  "parent": null,
  "blocked_by": [],
  "estimate": null,
  "due_date": null,
  "logs": [
    {
      "ts": "2026-01-26T19:06:07.757Z",
      "msg": "Mode transitions audit:\n\n**Mode State Machine:**\n- Input → Selector: Ctrl+M (model), Ctrl+P (provider), /resume, first-time setup\n- Input → Approval: Automatic when approval request arrives in update()\n- Input → HelpOverlay: Ctrl+H, '?', /help\n- Selector → Input: Esc, Enter (selection complete), Ctrl+C (single tap)\n- Approval → Input: After response (y/n/a/A/Esc)\n- HelpOverlay → Input: Any key\n\n**Protections:**\n- Ctrl+M/Ctrl+P blocked while is_running\n- Selector Esc behavior differs during needs_setup (goes to provider instead of Input)\n- Ctrl+C double-tap quits from any mode\n\n**Potential Issues:**\n1. **Approval interrupts any mode**: update() sets mode=Approval regardless of current mode. If in HelpOverlay or Selector, user gets jumped to Approval. This is probably correct (approval takes priority) but could surprise users.\n\n2. **HelpOverlay can open while running**: Ctrl+H works during is_running. Low impact but inconsistent with Ctrl+M/Ctrl+P behavior.\n\nNo critical bugs found."
    }
  ],
  "created_at": "2026-01-26T18:59:18.857Z",
  "updated_at": "2026-01-26T19:06:12.654Z",
  "completed_at": "2026-01-26T19:06:12.654Z",
  "external": {}
}