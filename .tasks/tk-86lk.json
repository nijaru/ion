{
  "project": "tk",
  "ref": "86lk",
  "title": "[BUG] --continue header pinning breaks scrollback",
  "description": "In TUI resume/continue flow, header appears pinned to top and bottom fills with blank lines while scrolling. Desired behavior: bottom UI stays locked; top/header should not be force-pinned except when actively composing input.",
  "status": "active",
  "priority": 2,
  "labels": [],
  "assignees": [],
  "parent": null,
  "blocked_by": [],
  "estimate": null,
  "due_date": null,
  "logs": [
    {
      "ts": "2026-02-11T01:13:47.269Z",
      "msg": "Starting investigation in run/render_state resume path. Goal: stop header pinning and bottom newline accumulation during scrollback in --continue."
    },
    {
      "ts": "2026-02-11T01:18:31.283Z",
      "msg": "Root cause: startup resume path sets ChatPosition::Tracking when history fits viewport (position_after_reprint), which top-anchors UI/header and leaves large blank region. Patched run.rs to force Scrolling mode after resume reprint."
    },
    {
      "ts": "2026-02-11T01:18:39.230Z",
      "msg": "Validation: cargo test passed (434 tests)."
    },
    {
      "ts": "2026-02-11T01:32:27.015Z",
      "msg": "Adjusted startup resume reprint: when history is shorter than available chat rows, apply ScrollDown padding so content is bottom-aligned above UI (no top pinning for short history). Keep position Scrolling for bottom-locked UI."
    },
    {
      "ts": "2026-02-11T01:40:25.553Z",
      "msg": "Re-evaluating fix quality: user reports current behavior still wrong. Performing full resume render-path audit to replace startup padding workaround with source-level layouted reprint."
    },
    {
      "ts": "2026-02-11T01:41:45.103Z",
      "msg": "Replaced workaround with source-level startup resume layout: build lines first, compute available chat rows, render short histories at computed start_row above UI, render long histories from top with overflow trim; mark reflow complete and force Scrolling mode."
    },
    {
      "ts": "2026-02-11T01:49:33.470Z",
      "msg": "User requested no alignment. Updated startup resume path to render history from row 0 and only trim overflow for UI. Removed short-history start-row alignment logic."
    },
    {
      "ts": "2026-02-11T01:50:15.891Z",
      "msg": "Fix follow-up: cap resume overflow trim to visible viewport (min(line_count, term_height)) to avoid overscroll on long histories."
    }
  ],
  "created_at": "2026-02-11T01:13:44.111Z",
  "updated_at": "2026-02-11T01:50:15.891Z",
  "completed_at": null,
  "external": {}
}