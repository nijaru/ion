{
  "project": "tk",
  "ref": "5lfp",
  "title": "Design TUI region/layout abstraction for overlays",
  "description": "Current TUI has ad-hoc position management for popups, selectors, and overlays. Each new overlay feature (command completer, file completer, history search, provider/model picker) requires manual position arithmetic and clearing logic. Design a Region/Layout abstraction that:\n1. Declares components and their height requirements\n2. Computes positions in a layout pass (top-down from ui_start)\n3. Clears the entire UI area once, renders components in order\n4. Handles popup appear/disappear by growing/shrinking the layout stack\n5. Unifies popup rendering pattern across all overlay types\n\nConsider: alternate viewport mode as alternative approach. Research Codex CLI's custom_terminal.rs approach vs improved inline rendering.\n\nSee: ai/design/tui-v2.md, DECISIONS.md 2026-01-27 entry, ai/research/ viewport docs.",
  "status": "done",
  "priority": 3,
  "labels": [],
  "assignees": [],
  "parent": null,
  "blocked_by": [],
  "estimate": null,
  "due_date": null,
  "logs": [
    {
      "ts": "2026-02-09T05:59:26.293Z",
      "msg": "Implemented all 3 phases: unified popup renderer (popup.rs), split direct.rs into 5 component modules, compute_layout() with Region/UiLayout/BodyLayout. 403 tests pass, clippy clean."
    },
    {
      "ts": "2026-02-09T07:08:45.096Z",
      "msg": "Review fixes applied (1584e3f): saturating_sub underflow, progress-in-HistorySearch, PopupRegion->Region re-export, secondary padding, dead _height param"
    }
  ],
  "created_at": "2026-02-09T05:23:49.982Z",
  "updated_at": "2026-02-09T07:08:45.096Z",
  "completed_at": "2026-02-09T05:59:26.270Z",
  "external": {}
}